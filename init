#!/bin/bash

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# Add local bin
export PATH=$DIR/root/bin/:$PATH

# Path to servers
SERVER=cs164-$1@torus.cs.berkeley.edu
PROJ_PATH="~/work/compyler"

function sendcorr {
	scp -r $DIR/tests/correct2/* $SERVER:$PROJ_PATH/tests/correct2
}

function senderr {
	scp -r $DIR/tests/error2/* $SERVER:$PROJ_PATH/tests/error2
}

function sendsrc {
  if [ -z $1 ]
  then
    scp -r $DIR/src/* $SERVER:$1
  else
    scp -r $DIR/src/* $SERVER:$PROJ_PATH/src
  fi
}

function connect {
  ssh $SERVER
}

function testcor {
  if [ $1 == -s ]
  then
    TEST=$2
  else
    TEST=$1
  fi

  printf "\nRunning apyc...\n"
  ./apyc --phase=2 -o out tests/correct2/$TEST.py
  printf "\nActual program...\n"
  tail -n +1272 out
  printf "\nUnparsing out...\n"
  pyunparse -o output out

  if [ $1 != -s ]
  then
    echo output
    rm out
    rm output
  else
    printf "\nSaved in 'out' and 'output'\n"
  fi
}
